(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{17:function(e,t,n){e.exports={from:"home_from__1iJOB",table:"home_table__2bqy3",container:"home_container__3vpxv"}},18:function(e,t,n){e.exports={container:"message_container__zCDX9",message:"message_message__2Itux",timer:"message_timer__3zM_C"}},32:function(e,t,n){e.exports={container:"navbar_container__KgCiU"}},34:function(e,t,n){e.exports={container:"login_container__2S0Q1"}},36:function(e,t,n){e.exports=n(61)},58:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(2),l=n(11),r=n(35),c=n(16),i=function(){var e=localStorage.getItem("token");return!c.a.isEmpty(e)},u=n(12),s=n(32),f=n.n(s);var d=Object(u.withRouter)((function(e){var t=e.history;return a.default.createElement("nav",{className:f.a.container},a.default.createElement("span",null,a.default.createElement(u.Link,{class:"wordmark",href:"/"},a.default.createElement("img",{src:"/logo192.png"})," ",a.default.createElement("span",null,"Bottle"))),a.default.createElement("span",null,a.default.createElement(u.Link,{to:"/"},"Send your own message."),a.default.createElement("button",{onClick:function(){localStorage.removeItem("token"),t.push("/login")}},"Logout")))}));var m=Object(o.withRouter)((function(e){var t=e.component,n=e.history,l=Object(r.a)(e,["component","history"]);return Object(a.useEffect)((function(){i()||n.push("/login")}),[n]),a.default.createElement(a.default.Fragment,null,a.default.createElement(o.Route,Object.assign({},l,{render:function(e){return a.default.createElement(t,e)}})))})),p=n(10),g=n(15),h=n(8),v=n(6),E=n.n(v),b=n(17),w=n.n(b);function y(){var e=Object(a.useState)([]),t=Object(h.a)(e,2),n=t[0],o=t[1],r=Object(a.useState)([]),c=Object(h.a)(r,2),i=c[0],s=c[1],f=function(){E.a.get("").then((function(e){o(e.data)})).catch((function(e){console.log(e)}))};Object(a.useEffect)((function(){f()}),[]);var d=function(e){var t=e.target,n=t.name,a=t.value;s(Object(g.a)({},i,Object(p.a)({},n,a)))},m=function(e){e.preventDefault(),E.a.post("",i).then((function(e){f()})).catch((function(e){console.log(e.response.data),l.b.error(e.message)}))};return a.default.createElement("div",{className:w.a.container},a.default.createElement("h1",null,"Write a bottled message"),a.default.createElement("form",{className:w.a.from,onSubmit:m},a.default.createElement("input",{type:"text",name:"message",placeholder:"write your message",value:i.message,onChange:d}),a.default.createElement("input",{type:"number",name:"expiry",placeholder:"Self-destruct Timer in minutes",value:i.expiry,onChange:d}),a.default.createElement("input",{type:"submit",value:"Generate Link",onChange:m})),a.default.createElement("table",{className:w.a.table},a.default.createElement("thead",null,a.default.createElement("tr",null,a.default.createElement("th",null,"MESSAGE"),a.default.createElement("th",null,"URL"),a.default.createElement("th",null))),a.default.createElement("tbody",null,n.map((function(e){return a.default.createElement("tr",{key:e.id},a.default.createElement("td",null,e.message),a.default.createElement("td",null,a.default.createElement(u.Link,{to:e.id},e.id)),a.default.createElement("th",null,a.default.createElement("button",{onClick:function(){return function(e){var t={title:"Bottled Message",text:"Check this url",url:e};try{navigator.share(t)}catch(n){}}(e.id)}},"Share")))})))))}var _=n(34),j=n.n(_);var k=Object(o.withRouter)((function(e){var t=e.history;Object(a.useEffect)((function(){i()&&t.push("/")}),[]);var n=Object(a.useState)({}),o=Object(h.a)(n,2),r=o[0],c=o[1],u=function(e){var t=e.target,n=t.name,a=t.value;c(Object(g.a)({},r,Object(p.a)({},n,a)))},s=function(e){e.preventDefault(),E.a.post("/login",r).then((function(e){console.log(e),localStorage.setItem("token",e.data.token),t.push("/")})).catch((function(e){console.log(e.response.data),l.b.error(e.message)}))};return a.default.createElement("div",{className:j.a.container},a.default.createElement("form",{onSubmit:s},a.default.createElement("input",{type:"email",name:"email",placeholder:"email",value:r.email,onChange:u}),a.default.createElement("input",{type:"password",placeholder:"password",name:"password",value:r.password,onChange:u}),a.default.createElement("input",{type:"submit",value:"login",onChange:s})))})),O=(n(58),n(18)),S=n.n(O);function x(){var e=Object(o.useParams)().id,t=Object(a.useState)({}),n=Object(h.a)(t,2),l=n[0],r=n[1],c=function(){E.a.get("/".concat(e)).then((function(e){var t;t=e.data.message,new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)?window.location=e.data.message:r(e.data)})).catch((function(e){console.log(e)}))};return Object(a.useEffect)((function(){c()}),[]),a.default.createElement("div",{className:S.a.container},a.default.createElement("div",{className:S.a.message},a.default.createElement("p",{className:""},l.message)),a.default.createElement("div",{className:S.a.timer},"Message will disappear in ",a.default.createElement("span",{"data-time":"3267"},"54m 27s")))}var C=function(){return a.default.createElement("div",{className:"App"},a.default.createElement(l.a,null),a.default.createElement(d,null),a.default.createElement(o.Switch,null,a.default.createElement(o.Route,{exact:!0,path:"/login",component:k}),a.default.createElement(o.Route,{exact:!0,path:"/:id([0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12})",component:x}),a.default.createElement(m,{exact:!0,path:"/",component:y})))},N=(n(59),n(9)),R=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function z(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(60);E.a.defaults.baseURL="/api",E.a.interceptors.request.use((function(e){var t=localStorage.getItem("token");return c.a.isEmpty(t)||(e.headers.Authorization=t),console.log(e),e}),(function(e){return Promise.reject(e)})),a.default.render(a.default.createElement(a.default.StrictMode,null,a.default.createElement(N.a,null,a.default.createElement(C,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");R?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):z(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):z(t,e)}))}}()}},[[36,1,2]]]);
//# sourceMappingURL=main.1fa1c610.chunk.js.map